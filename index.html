<!DOCTYPE html>
<html>
    <head>
        <title>
            RockPaperScissors
        </title>
    </head>
    <body>
        <h1>
            Dare to play ...
        </h1>
        <div id="select">
            <button id="rock" class="option">Rock</button>
            <button id="paper" class="option">Paper</button>
            <button id="scissors" class="option">Scissors</button>
        </div>
        <p id="roundResult">

        </p>
        <div id="result">
            <div id="usercon">
                <p>You</p>
                <p id="usersc">0</p>
            </div>
            <p>-</p>
            <div id="compcon">
                <p>Computer</p>
                <p id="compsc">0</p>
            </div>
        </div>
        <div>
            <p id="finalres">
                
            </p>
        </div>
    </body>
    <script>
        function computerSelection(){
            let choices = ["rock","paper","scissors"];
            return choices[Math.floor(Math.random()*3)];
        }

        function play (playerSelection,computerSelection){
            pl = playerSelection.toUpperCase();
            comp = computerSelection.toUpperCase();

            if (pl == "ROCK"){
                switch(comp){
                    case "ROCK":
                        return "Draw, rock vs rock.";
                    
                    case "PAPER":
                        return "You lose, paper beats rock.";

                    case "SCISSORS":
                        return "You win, rock beats scissors."

                    default:
                        return "error, computer cheated";
                }
            }

            else if (pl == "PAPER"){
                switch(comp){
                    case "ROCK":
                        return "You win, paper beats rock.";
                    
                    case "PAPER":
                        return "Draw, paper vs paper.";

                    case "SCISSORS":
                        return "You lose, scissors beat paper."

                    default:
                        return "error, computer cheated";
                }
            }

            else if (pl == "SCISSORS"){
                switch(comp){
                    case "ROCK":
                        return "You lose, rock beats scissors.";
                    
                    case "PAPER":
                        return "You win, scissors beat paper.";

                    case "SCISSORS":
                        return "Draw, scissors vs scissors."

                    default:
                        return "error, computer cheated";
                }
            }

            else{
                return "come on ... don't cheat";
            }
        }

        function singleRound(plop){
            
            let compop = computerSelection();
            let result = play(plop,compop);
            document.querySelector("#roundResult").textContent = result;

            result = result.toLowerCase();
                
            if (result.includes("win")){
                let usersc = document.querySelector("#usersc");
                let plsc = parseInt(usersc.textContent);
                usersc.textContent = ++plsc;

                if(plsc==5){
                    endgame("u");
                }
            }
            if (result.includes("lose")){
                let comsc = document.querySelector("#compsc");
                let compsc = parseInt(comsc.textContent);
                comsc.textContent = ++compsc;

                if(compsc==5){
                    endgame("c");
                }
            }

            if(result.includes("cheat")){
                alert(result);
            }
        }

        function game (){
            
            let buttonRock = document.querySelector("#rock");
            let buttonPaper = document.querySelector("#paper");
            let buttonScissors = document.querySelector("#scissors");

            buttonRock.addEventListener("click",()=>{singleRound("rock")});
            buttonPaper.addEventListener("click",()=>{singleRound("paper")});
            buttonScissors.addEventListener("click",()=>{singleRound("scissors")});

        }

        function endgame (res){
            let options = document.querySelector("#select");
            options.parentNode.removeChild(options);

            let finres = document.querySelector("#finalres");

            if(res=="u"){
                finres.textContent = "You won this match ...";
            }

            if(res=="c"){
                finres.textContent = "ha! you lose ...";
            }

            let docbody = document.querySelector("body");
            let rematch = document.createElement('p');
            rematch.textContent = "Want a rematch ??? Hit the reload button ...";
            docbody.appendChild(rematch);
        }
        
        game();

    </script>
</html>